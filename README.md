# Mysterious
åˆ†å¸ƒå¼å‹æµ‹å¹³å°ï¼Œå‰ç«¯Vue3+TypeScriptï¼Œåç«¯SpringBoot-2.3.12ï¼Œå‹æµ‹å¼•æ“JMeter-5.5ï¼Œæ”¯æŒJMeterçš„åˆ†å¸ƒå¼å‹æµ‹ï¼Œç®¡ç†ï¼Œæ‰§è¡Œï¼ŒæŠ¥å‘Šï¼Œæ—¥å¿—ç­‰ã€‚å› ä¸ºè®¾è®¡ï¼Œå¼€å‘ï¼Œæµ‹è¯•éƒ½æ˜¯è‡ªå·±ï¼Œä¸€äº›åŠŸèƒ½ä¼˜åŒ–éœ€æ±‚ä¹Ÿæ˜¯æ ¹æ®è‡ªå·±çš„ä½¿ç”¨æ¥æ”¹è¿›ï¼Œç›®å‰ä¸»è¦ä¼˜å…ˆè€ƒè™‘æ­£ç¡®æ€§å’Œå®ç”¨æ€§ï¼Œæœªæ¥é€šè¿‡å¤§æ¨¡å‹ç”ŸæˆJMXè„šæœ¬ä¹Ÿåœ¨è€ƒè™‘å½“ä¸­ã€‚

https://github.com/user-attachments/assets/514c7ab6-08a6-4576-9af1-9dafe60a0589

## ğŸ”¥ ç»éªŒæ€»ç»“
- [1. JMeteråˆ†å¸ƒå¼å‹æµ‹](https://lihuia.com/jmeter%e5%88%86%e5%b8%83%e5%bc%8f%e5%8e%8b%e6%b5%8b/)
- [2. JMeteræœ‰å…³JARä¾èµ–å¼‚å¸¸é—®é¢˜](https://lihuia.com/jmeter%e6%9c%89%e5%85%b3jar%e4%be%9d%e8%b5%96%e7%9a%84%e9%97%ae%e9%a2%98/)
- [3. åè¡€å®šä½ç«¯å£æ˜ å°„å½±å“JMeteråˆ†å¸ƒå¼å‹æµ‹çš„å¼‚å¸¸é—®é¢˜](https://lihuia.com/%e5%90%90%e8%a1%80%e5%ae%9a%e4%bd%8d%e7%ab%af%e5%8f%a3%e6%98%a0%e5%b0%84%e5%bd%b1%e5%93%8djmeter%e5%88%86%e5%b8%83%e5%bc%8f%e5%8e%8b%e6%b5%8b%e7%9a%84%e5%bc%82%e5%b8%b8%e9%97%ae%e9%a2%98/)
- [4. JMeteråˆ†å¸ƒå¼å‹æµ‹å¯åŠ¨æµç¨‹ç®€è¿°](https://lihuia.com/jmeter%e5%88%86%e5%b8%83%e5%bc%8f%e5%8e%8b%e6%b5%8b%e5%90%af%e5%8a%a8%e6%b5%81%e7%a8%8b%e7%ae%80%e8%bf%b0/)
- [5. JMeteråˆ†å¸ƒå¼å¹³å°åŒ–ç›¸å…³çš„å¼‚å¸¸é—®é¢˜æ±‡æ€»](https://lihuia.com/jmeter%e5%88%86%e5%b8%83%e5%bc%8f%e7%9b%b8%e5%85%b3%e7%9a%84%e5%bc%82%e5%b8%b8%e9%97%ae%e9%a2%98%e6%b1%87%e6%80%bb/)
- [6. åˆ†å¸ƒå¼å‹æµ‹å¹³å°å“åº”æ—¶é—´çš„æŸè€—åˆ†æ](https://lihuia.com/%e5%8e%8b%e6%b5%8b%e5%b9%b3%e5%8f%b0%e5%93%8d%e5%ba%94%e6%97%b6%e9%97%b4%e7%9a%84%e6%8d%9f%e8%80%97%e5%88%86%e6%9e%90/)
- [7. å¹³å°åŒ–ï¼šJMeterè„šæœ¬åœ¨çº¿ç¼–è¾‘åˆæ­¥å®ç°](https://lihuia.com/%e5%b9%b3%e5%8f%b0%e5%8c%96%ef%bc%9ajmeter%e8%84%9a%e6%9c%ac%e5%9c%a8%e7%ba%bf%e7%bc%96%e8%be%91%e5%88%9d%e6%ad%a5%e5%ae%9e%e7%8e%b0/)
- [8. Grafanaå’ŒInfluxDBå¸®JMeteræå‡æ€§èƒ½ç›‘æ§çš„ç¾æ„Ÿ](https://lihuia.com/grafana%e5%92%8cinfluxdb%e5%b8%aejmeter%e5%b1%95%e7%a4%ba%e7%be%8e%e8%a7%82%e7%9a%84%e6%80%a7%e8%83%bd%e7%9b%91%e6%8e%a7/)


## ğŸ”¥ å¹³å°æ¨¡å—
- åç«¯æœåŠ¡ï¼šhttps://github.com/100ZZ/mysterious
- å‰ç«¯æœåŠ¡ï¼šhttps://github.com/100ZZ/mysterious-web
- å‹æµ‹å¼•æ“ï¼šhttps://github.com/100ZZ/mysterious-jmeter
- å¹³å°è¯•ç”¨ï¼šhttp://101.43.119.176:1234 (demo/demoæˆ–è€…æ–°æ³¨å†Œä¸ªç”¨æˆ·)

## ğŸ”¥ æµ‹è¯•æµç¨‹
- æœ¬åœ°ä¸Šä¼ ï¼šæœ¬åœ°èƒ½è¿è¡Œçš„æµ‹è¯•ï¼Œä¸Šä¼ æµ‹è¯•çš„JMXï¼ŒCSVï¼ŒJARç­‰ä¾èµ–ï¼Œå¹³å°å‡å¯ç›´æ¥å¤„ç†å’Œæ‰§è¡Œï¼Œæ—¥å¿—ï¼ŒæŠ¥å‘Š
  ```
  - æ–°å»ºç”¨ä¾‹ï¼šä¼šåœ¨MasterèŠ‚ç‚¹åˆ›å»ºç”¨ä¾‹å‘½åç©ºé—´è·¯å¾„
  - ä¸Šä¼ JMXï¼šæœ¬åœ°è°ƒè¯•å¥½çš„JMXï¼ˆæ¯”å¦‚å·²ç»å…³è”äº†æœ¬åœ°çš„CSVå’ŒJARï¼‰ï¼Œé¡µé¢ä¸Šä¼ æ“ä½œï¼Œä¼šå­˜æ”¾åˆ°å¯¹åº”ç”¨ä¾‹è·¯å¾„ä¸‹
  - ä¸Šä¼ CSVï¼šæœ‰ä¸€ä¸ªé™åˆ¶ï¼Œæœ¬åœ°è°ƒè¯•çš„æ—¶å€™ï¼ŒCSV Data Set Configçš„Nameéœ€è¦è®¾ç½®ä¸ºä¸Šä¼ çš„CSVæ–‡ä»¶åå¸¦åç¼€ï¼Œä»¥ä¾¿ä¸Šä¼ åå¹³å°ä¿®æ”¹CSVæ¨¡å—
  - ä¸Šä¼ JARï¼šæ²¡å•¥é™åˆ¶ï¼Œä¸Šä¼ åï¼Œå¹³å°ä¼šä¿®æ”¹JMXè„šæœ¬çš„ClassPathæ¨¡å—
  ```
- åœ¨çº¿ç”Ÿæˆï¼šä¸»è¦æ˜¯JMXè„šæœ¬ï¼Œå®Œæˆä¸€äº›ç®€å•çš„è„šæœ¬è¿›è¡Œåœ¨çº¿ç¼–å†™ï¼Œæ¯•ç«ŸJMeterå„ç§æ’ä»¶ä¼—å¤šï¼Œä¸å¯èƒ½éƒ½å…¼å®¹
  ```
  - Threadsï¼šThreadGroupï¼ŒSteppingThreadGroupï¼ŒConCurrencyThreadGroup
  - Samplerï¼šHttpSamplerï¼ŒJavaRequestï¼ŒDubboSampler
  - Assertionï¼šResponseCodeï¼ŒResponseMessageï¼ŒJSONPath
  - å…¶å®ƒï¼šå¦‚æœè¿˜æœ‰æ— æ³•æ»¡è¶³çš„æµ‹è¯•éœ€æ±‚ï¼Œå¯ä»¥ç›´æ¥æœ¬åœ°ä¸Šä¼ çš„æ–¹å¼æ¥è¿›è¡Œæµ‹è¯•
  ```
- æ™ºèƒ½ç”Ÿæˆï¼šåç»­è€ƒè™‘ç»“åˆAIå¤§æ¨¡å‹ï¼Œæä¾›å¯è§†åŒ–promptæç¤ºè¯è¾“å…¥ï¼ŒæŒ‰è¦æ±‚ç”ŸæˆJMXè„šæœ¬ã€
  
## ğŸ”¥ éƒ¨ç½²æ¶æ„
- å¦‚æœæ˜¯å•èŠ‚ç‚¹å‹æµ‹ï¼Œåªéœ€è¦åœ¨MasterèŠ‚ç‚¹ä¸Šå®‰è£…éƒ¨ç½²å¹³å°ï¼ˆåŒ…æ‹¬å‹æµ‹å¼•æ“ï¼‰ï¼Œé€šè¿‡å¹³å°æ¥è°ƒç”¨æœ¬åœ°å‹æµ‹å¼•æ“è¿›è¡Œå•èŠ‚ç‚¹å‹æµ‹ï¼Œè¿”å›å‹æµ‹ç»“æœ
- å¦‚æœæ˜¯åˆ†å¸ƒå¼å‹æµ‹ï¼Œé™¤äº†MasterèŠ‚ç‚¹å®‰è£…éƒ¨ç½²å¹³å°ï¼ˆåŒ…æ‹¬å‹æµ‹å¼•æ“ï¼‰å¤–ï¼Œè¿˜è¦åœ¨SlaveèŠ‚ç‚¹ä¸Šéƒ¨ç½²å‹æµ‹å¼•æ“ï¼Œå¯åŠ¨jmeter-serveræœåŠ¡
<kbd>![fenbu](https://github.com/user-attachments/assets/b0ed73af-f839-4485-a40e-b487da475eb0)</kbd>

## ğŸ”¥ å®‰è£…éƒ¨ç½²
### âš™ï¸ MasterèŠ‚ç‚¹ï¼šå¹³å°Docker-Composeéƒ¨ç½²æ–¹å¼ï¼ˆæ¨èï¼Œä¸€é”®éƒ¨ç½²ï¼‰
å®¹å™¨åŒ–éƒ¨ç½²é€šè¿‡docker-composeæ–¹å¼åœ¨MasterèŠ‚ç‚¹ä¸€é”®éƒ¨ç½²å‹æµ‹å¹³å°ï¼Œå¦‚æœåœ¨çº¿æ‹‰é•œåƒä¸ç•…ï¼Œç½‘ç›˜é‡Œä¸‹æœ€æ–°ç‰ˆæœ¬ç¦»çº¿å®¹å™¨é•œåƒï¼ˆåŒ…æ‹¬x86å’Œarm64ï¼‰
> ç¦»çº¿é•œåƒï¼šhttps://pan.baidu.com/s/128k3uiUvaKf0vgbD-BO28Q?pwd=e9qy æå–ç : e9qy

1. å¹³å°éƒ¨ç½²
>- git clone https://github.com/100ZZ/mysterious.git
>- cd mysterious/docker
>- sh init.sh amd64|arm64 ï¼ˆå‚æ•°ï¼šx86ä¼ amd64ï¼Œarmä¼ arm64ï¼›init.shå¯è‡ªå®šä¹‰å¹³å°æ•°æ®ç›®å½•ï¼‰
>- cd ./mysterious
>- git clone https://github.com/100ZZ/mysterious-jmeter.git
>- docker-compose up -d
2. è®¿é—®å¹³å°
>- å¹³å°è®¿é—®ï¼šhttp://xx.xx.xx.xx:1234
>- Swaggeræ–‡æ¡£ï¼šhttp://xx.xx.xx.xx:4321/swagger-ui.html
3. è¿è¡Œé…ç½®
>- å†…å­˜é…ç½®ï¼šdocker-compose.ymlé‡Œåç«¯æœåŠ¡é¢„åˆ†é…äº†1Gå†…å­˜ï¼Œå¯æ ¹æ®éœ€æ±‚è°ƒæ•´
>- å¼•æ“å†…å­˜ï¼šmysterious-jmeter/bin/jmeteré‡Œé…ç½®HEAPå†…å­˜2g-4g-512mï¼Œå¯æ ¹æ®éœ€æ±‚è‡ªè¡Œè°ƒæ•´
>- é…ç½®ç®¡ç†ï¼šMASTER_HOST_PORTä¿®æ”¹ä¸ºæœ¬åœ°IP:PORTï¼Œä½œä¸ºå‹æµ‹æŠ¥å‘Šé¢„è§ˆçš„è·¯å¾„å‰ç¼€ï¼Œä¿®æ”¹å®Œé‡å¯å®¹å™¨
>- è¿è¡Œè·¯å¾„ï¼šMasterå’ŒSlaveèŠ‚ç‚¹æœ‰å…³å¼•æ“çš„æ‰§è¡Œè·¯å¾„éƒ½å¯ä»¥åœ¨é…ç½®ç®¡ç†é‡Œè¿›è¡Œä¿®æ”¹ï¼Œç„¶åé‡å¯å®¹å™¨
4. ç‰ˆæœ¬æ›´æ–°
>- åç«¯æ›´æ–°ï¼šæ›´æ–°mysteriouså®¹å™¨(æœ€æ–°çš„docker/${æ¶æ„}.envé…ç½®è¦†ç›–${BASE_DIR}/.env)ï¼Œé‡å¯å®¹å™¨
>- å‰ç«¯æ›´æ–°ï¼šæ›´æ–°distç›®å½•ï¼Œè¦†ç›–docker/mysterious/nginx/html/distï¼Œé‡å¯mysterious-nginxå®¹å™¨
>- åº“è¡¨å˜æ›´ï¼šæ£€æŸ¥æ•°æ®åº“è„šæœ¬(docker/init.sql)ï¼Œæ‰§è¡Œå˜æ›´éƒ¨åˆ†çš„sqlå³å¯ï¼›å› ä¸ºdbå®¹å™¨åˆå§‹åŒ–sqlåªé¦–æ¬¡ç”Ÿæ•ˆ

### âš™ï¸ MasterèŠ‚ç‚¹ï¼šå¹³å°äºŒè¿›åˆ¶éƒ¨ç½²æ–¹å¼
ä¸‹é¢ä»¥CentOS7ä¸ºä¾‹ä»‹ç»ä¸‹å®‰è£…æ­¥éª¤
1. å‰ç«¯éƒ¨ç½²
>- git clone https://github.com/100ZZ/mysterious-web.git
>- cd mysterious-web
>- npm install
>- npm run build (ç”Ÿæˆdistï¼Œå¦‚æœä¸æƒ³buildï¼Œmysteriousçš„dockeré‡Œæœ‰æœ€æ–°çš„dist)
2. å®‰è£…nginxï¼Œmysqlï¼Œredisï¼Œjdk8+
> nginx
>- 1234.confå’Œ9998.confå¤åˆ¶åˆ°/etc/nginx/conf.dä¸‹ï¼ˆæ ¹æ®ç³»ç»Ÿå®é™…æƒ…å†µï¼‰ï¼Œå¹¶ä¿®æ”¹ä¸‹ï¼Œæ¯”å¦‚mysterious-nginxæ”¹æˆlocalhostï¼Œmysteriousæ”¹æˆæœ€åå‰ç«¯é¡µé¢è®¿é—®çš„IPåœ°å€ï¼Œä¸€äº›locationè·¯å¾„ä¸€å¹¶ä¿®æ”¹
>- mkdir -p /usr/share/nginx/html/
>- cp -r [ä¸Šä¸€æ­¥å‰ç«¯ç›®å½•]/dist /usr/share/nginx/html/

> mysql
>- mysql> ALTER USER 'root'@'localhost' IDENTIFIED BY 'Test@123456';
>- mysql> use mysql;
>- mysql> update user set host='%' where user='root';

> redis
>- æ²¡å•¥å¥½è¯´çš„ï¼Œèµ·æ¥å°±è¡Œäº†ï¼Œä¸ç”¨è®¾å¯†ç 
>- redis.confå¯è‡ªè¡Œä¸‹è½½ï¼Œæˆ–è€…dockerç›®å½•ä¸‹æœ‰

3. åç«¯éƒ¨ç½²
>- git clone https://github.com/100ZZ/mysterious.git
>- mvn -f pom.xml clean install package -Dmaven.test.skip=true
>- mkdir -p /opt/mysterious/mysterious-data
>- mkdir -p /opt/mysterious/running
>- cp docker/mysterious.jar /opt/mysterious/running/
>- cp docker/service.sh /opt/mysterious/running/
>- cd /opt/mysterious
>- git clone https://github.com/100ZZ/mysterious-jmeter.git
>- sh /opt/mysterious/running/service.sh restart
4. è®¿é—®å¹³å°
>- å¹³å°è®¿é—®ï¼šhttp://xx.xx.xx.xx:1234
>- Swaggeræ–‡æ¡£ï¼šhttp://xx.xx.xx.xx:4321/swagger-ui.html
>- åŒæ ·çš„å†…å­˜é…ç½®ç›¸å…³çš„ï¼Œå‚è€ƒdocker-composeéƒ¨åˆ†çš„è¯´æ˜

### âš™ï¸ SlaveèŠ‚ç‚¹ï¼šå‹æµ‹å¼•æ“éƒ¨ç½²ï¼ˆåˆ†å¸ƒå¼å‹æµ‹ï¼ŒSlaveä½œä¸ºå‹åŠ›æœºï¼Œå¯åŠ¨Jmeter-ServeræœåŠ¡ï¼‰
>- æ— ç‰¹æ®Šæƒ…å†µï¼Œæ¨èé«˜é…ç½®å•èŠ‚ç‚¹éƒ¨ç½²æ¥è¿›è¡Œå‹æµ‹å°±è¡Œäº†ï¼Œå› ä¸ºåˆ†å¸ƒå¼å‹æµ‹äº¤äº’ä¹Ÿæœ‰å¼€é”€
>- æ— SlaveèŠ‚ç‚¹AgentæœåŠ¡å¯ç”¨ï¼Œå°±åªæœ‰Masterå•èŠ‚ç‚¹è¿›è¡Œå‹æµ‹
>- åªè¦æœ‰SlaveèŠ‚ç‚¹AgentæœåŠ¡å¯ç”¨ï¼Œå°±ä¼šè¿›è¡Œåˆ†å¸ƒå¼å‹æµ‹ï¼ŒMasterèŠ‚ç‚¹ä½œä¸ºClient

å¦‚æœéœ€è¦åˆ†å¸ƒå¼å‹æµ‹ï¼Œæ‰¾åˆ°å’ŒMasterèŠ‚ç‚¹ç½‘ç»œäº’é€šçš„SlaveèŠ‚ç‚¹è¿›è¡Œéƒ¨ç½²ï¼Œæœ€å¥½æ˜¯å±€åŸŸç½‘ï¼Œå¦åˆ™ç½‘ç»œå¼€é”€å¤ªå¤§ï¼›æ— è®ºMasterèŠ‚ç‚¹æ˜¯äºŒè¿›åˆ¶è¿˜æ˜¯Docker-Composeéƒ¨ç½²ï¼ŒSlaveèŠ‚ç‚¹éƒ¨ç½²æ–¹å¼éƒ½å¦‚ä¸‹
>- mkdir /opt/mysterious
>- cd /opt/mysterious
>- git clone https://github.com/100ZZ/mysterious-jmeter.git
>- å¦‚æœä¹‹å‰æœ‰ä¸€äº›æµ‹è¯•ç”¨ä¾‹ï¼Œå¯ä»¥é¡µé¢èŠ‚ç‚¹ç®¡ç†ï¼Œå…ˆç‚¹å‡»ä¸€ä¸‹èŠ‚ç‚¹åŒæ­¥ï¼Œä¼šå°†MasterèŠ‚ç‚¹ç”¨ä¾‹æ•°æ®éƒ½åŒæ­¥åˆ°SlaveèŠ‚ç‚¹ï¼Œç„¶åå¯ç”¨SlaveèŠ‚ç‚¹å³å¯
>- åªè¦æœ‰SlaveèŠ‚ç‚¹å¯ç”¨ï¼Œå‹æµ‹éƒ½ä¼šæ˜¯åˆ†å¸ƒå¼å‹æµ‹ï¼Œå¦‚æœå…¨éƒ½ç¦ç”¨ï¼Œå‹æµ‹å°±åªæ˜¯Masterå•èŠ‚ç‚¹å‹æµ‹
>- å…·ä½“SlaveèŠ‚ç‚¹çš„ç›®å½•ç»“æ„éƒ½æ˜¯å¯é…ç½®çš„ï¼Œå…·ä½“å¯ä»¥å‚è€ƒé…ç½®ç®¡ç†é¡µé¢
>- åŒæ ·çš„å†…å­˜é…ç½®ç›¸å…³çš„ï¼Œå‚è€ƒdocker-composeéƒ¨åˆ†çš„è¯´æ˜
